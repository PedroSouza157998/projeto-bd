-- Tabela MULTA
CREATE TABLE MULTA (
    ID_MULTA VARCHAR(255),
    VALOR INT,
    CONSTRAINT PK_MULTA PRIMARY KEY (ID_MULTA));


-- Tabela BIBLIOTECA
CREATE TABLE BIBLIOTECA (
    COD_BIBLIOTECA INT ,
    NOME VARCHAR(255),
    END_NUM VARCHAR(20),
    END_LOG VARCHAR(255),
    CONSTRAINT PK_BIBLIOTECA PRIMARY KEY (COD_BIBLIOTECA)
);




-- Tabela EDITORA
CREATE TABLE EDITORA (
CNPJ VARCHAR(14),
NOME VARCHAR(255),
CONSTRAINT PK_EDITORA PRIMARY KEY (CNPJ)
);




-- Tabela LIVRO
CREATE TABLE LIVRO (
    ISBN VARCHAR(13),
    ANO INT,
    CNPJ VARCHAR(14),
    NOME VARCHAR(255),
    CONSTRAINT PK_LIVRO PRIMARY KEY (ISBN),
    CONSTRAINT FK_LIVRO_EDITORA FOREIGN KEY (CNPJ) REFERENCES EDITORA (CNPJ)
);




CREATE TABLE COPIA (
    ID INT ,
    ISBN VARCHAR(13),
    COD_BIBLIOTECA INT, 
    CONSTRAINT PK_COPIA PRIMARY KEY(ID),
    CONSTRAINT FK_COPIA_LIVRO FOREIGN KEY (ISBN) REFERENCES LIVRO (ISBN),
    CONSTRAINT FK_COPIA_COD_BIBLIO FOREIGN KEY (COD_BIBLIOTECA) REFERENCES BIBLIOTECA(COD_BIBLIOTECA)
);


-- Tabela Funcionario
CREATE TABLE FUNCIONARIO (
CPF VARCHAR(11) NOT NULL,
NOME VARCHAR(255),
COD_BIBLIOTECA INT,
CPF_GERENTE VARCHAR(11),
CONSTRAINT PK_FUNCIONARIO PRIMARY KEY (CPF),
CONSTRAINT FK_FUNCIONARIO_COD_BIBLIOTECA FOREIGN KEY (COD_BIBLIOTECA) REFERENCES BIBLIOTECA(COD_BIBLIOTECA),
CONSTRAINT FK_FUNCIONARIO_CPF FOREIGN KEY (CPF) REFERENCES FUNCIONARIO(CPF)
);


-- Tabela BIBLIOTECARIO
CREATE TABLE BIBLIOTECARIO (
CPF VARCHAR(11) NOT NULL,
COD_BIBLIOTECARIO INT,
CONSTRAINT PK_BIBLIOTECARIO PRIMARY KEY (CPF),
CONSTRAINT FK_BIBLIOTECARIO_CPF FOREIGN KEY (CPF) REFERENCES FUNCIONARIO(CPF)
);


-- Tabela Colaborador
CREATE TABLE COLABORADOR (
CPF VARCHAR(11) NOT NULL,
COD_COLABORADOR INT,
CARGO VARCHAR(255),
CONSTRAINT PK_COLABORADOR PRIMARY KEY (CPF),
CONSTRAINT FK_COLABORADOR_CPF FOREIGN KEY (CPF) REFERENCES FUNCIONARIO(CPF)
);


-- Tabela Usuario
CREATE TABLE USUARIO (
CPF VARCHAR(11) NOT NULL,
EMAIL VARCHAR(255),
TELEFONE VARCHAR(14),
CONSTRAINT PK_USUARIO PRIMARY KEY(CPF)
);


CREATE TABLE DEVOLVE (
CPF VARCHAR(11) NOT NULL,
ISBN VARCHAR(13) NOT NULL ,
ID_MULTA VARCHAR(255),
CONSTRAINT PK_DEVOLUCAO PRIMARY KEY(CPF,ISBN),
CONSTRAINT FK_DEVOLUCAO_USUARIO_CPF FOREIGN KEY (CPF) REFERENCES USUARIO(CPF),
CONSTRAINT FK_DEVOLUCAO_ID FOREIGN KEY (ISBN) REFERENCES LIVRO(ISBN),
CONSTRAINT FK_DEVOLUCAO_ID_MULTA FOREIGN KEY (ID_MULTA) REFERENCES MULTA(ID_MULTA)
);


-- Tabela GENERO
CREATE TABLE GENERO (
    ISBN VARCHAR(13),
    GENERO VARCHAR(255),
    CONSTRAINT PK_GENERO PRIMARY KEY (ISBN, GENERO),
    CONSTRAINT FK_GENERO_LIVRO FOREIGN KEY (ISBN) REFERENCES LIVRO (ISBN)
);


-- Tabela ALUGA
CREATE TABLE ALUGA (
    CPF VARCHAR(11) NOT NULL,
    ID INT,
    DATA_ALUGUEL DATE NOT NULL,
    COD_BIBLIOTECA INT NOT NULL,
    CONSTRAINT PK_ALUGA PRIMARY KEY (CPF, ID, DATA_ALUGUEL),
    CONSTRAINT FK_ALUGA_Usuario FOREIGN KEY (CPF) REFERENCES Usuario (CPF),
    CONSTRAINT FK_ALUGA_COPIA FOREIGN KEY (ID) REFERENCES COPIA (ID),
    CONSTRAINT FK_ALUGA_BIBLIOTECA FOREIGN KEY (COD_BIBLIOTECA) REFERENCES BIBLIOTECA (COD_BIBLIOTECA)
);